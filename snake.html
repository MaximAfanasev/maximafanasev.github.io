<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Авто Змейка</title>
	<link rel="stylesheet" href="style.css">
</head>
<style>
	* {
		margin: 0;
		padding: 0;
		box-sizing: border-box;
	}

	body {
		display: flex;
		justify-content: center;
		align-items: center;
		flex-direction: column;
		width: 100vw;
		height: 100vh;
		background-color: #263238;
		overflow: hidden;
		font-family: monospace;
		font-size: 18px;
		letter-spacing: 2px;
		color: #fff;
	}

	.game-container {
		position: relative;
	}

	canvas {
		margin-top: 50px;
		background-color: #263238;
		border: 1px solid #000000;
		width: 300px;
		height: 500px;
	}
	
</style>

<body>
	<h1>Изучение PYTHON</h1>
	<div class="game-container">
		<canvas id="gameCanvas" width="300" height="500"></canvas>
	</div>
	<script>
		const canvas = document.getElementById('gameCanvas');
		const ctx = canvas.getContext('2d');

		const box = 15; // размер клетки
		let snake;
		let food;
		let direction; // текущее направление
		let game;

		function resetGame() {
			snake = [{
				x: 4 * box,
				y: 4 * box
			}];
			food = {
				x: Math.floor(Math.random() * (canvas.width / box)) * box,
				y: Math.floor(Math.random() * (canvas.height / box)) * box
			};
			direction = 'RIGHT'; // начальное направление
			clearInterval(game); // Останавливаем предыдущую игру
			game = setInterval(draw, 100); // Запускаем игру заново
		}

		function draw() {
			ctx.clearRect(0, 0, canvas.width, canvas.height);

			// Рисуем змею
			for (let i = 0; i < snake.length; i++) {
				ctx.beginPath();
				ctx.arc(snake[i].x + box / 2, snake[i].y + box / 2, box / 2, 0, Math.PI * 1.8); // Используем arc для круга
				ctx.fillStyle = (i === 0) ? 'green' : 'lightgreen';
				ctx.fill();
				ctx.strokeStyle = 'darkgreen';
				ctx.stroke();
			}

			// Рисуем еду
			ctx.fillStyle = 'red';
			ctx.fillRect(food.x, food.y, box, box);

			// Логика движения змейки
			let snakeX = snake[0].x;
			let snakeY = snake[0].y;

			if (direction === 'LEFT') snakeX -= box;
			if (direction === 'UP') snakeY -= box;
			if (direction === 'RIGHT') snakeX += box;
			if (direction === 'DOWN') snakeY += box;

			// Проверка на сбитие с едой
			if (snakeX === food.x && snakeY === food.y) {
				// Создаем новую еду в случайном месте
				food = {
					x: Math.floor(Math.random() * (canvas.width / box)) * box,
					y: Math.floor(Math.random() * (canvas.height / box)) * box
				};
			} else {
				snake.pop(); // Удаляем последний сегмент змейки
			}

			// Обработка выхода за границы
			snakeX = (snakeX + canvas.width) % canvas.width;
			snakeY = (snakeY + canvas.height) % canvas.height;

			const newHead = {
				x: snakeX,
				y: snakeY
			};

			// Проверка на столкновение со своим телом
			if (collide(newHead, snake)) {
				resetGame(); // Перезагружаем игру
				return; // Выход из функции, чтобы не добавлять новую голову
			}

			snake.unshift(newHead); // Добавляем новую голову
			autoDirection(newHead); // Вызываем функцию для изменения направления
		}

		function collide(head, array) {
			for (let i = 1; i < array.length; i++) { // Начинаем с 1, чтобы не проверять голову
				if (array[i].x === head.x && array[i].y === head.y) {
					return true;
				}
			}
			return false;
		}

		function autoDirection(snakeHead) {
			// Логика самоуправления: поворачиваем к еде
			if (snakeHead.x < food.x) direction = 'RIGHT';
			else if (snakeHead.x > food.x) direction = 'LEFT';
			else if (snakeHead.y < food.y) direction = 'DOWN';
			else if (snakeHead.y > food.y) direction = 'UP';
		}

		// Инициализация первой игры
		resetGame();
	</script>
</body></html>