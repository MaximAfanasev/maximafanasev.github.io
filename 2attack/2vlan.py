
3. VLAN Hopping (Перепрыгивание VLAN)
Что это?
Атака, позволяющая злоумышленнику получить доступ к трафику другой VLAN, несмотря на сегментацию.

Основные методы:
1. Switch Spoofing
Атакующий подключается к порту и эмулирует Trunk-порт (DTP — Dynamic Trunking Protocol).

Если коммутатор поддерживает авто-Negotiation, злоумышленник получает доступ ко всем VLAN.

2. Double Tagging (QinQ)
Используется, если атакующий находится в той же VLAN, что и native VLAN транка.

Он добавляет два VLAN-тега:

Первый тег (наружный) — родная VLAN.

Второй тег (внутренний) — целевая VLAN.

Первый коммутатор снимает внешний тег, а второй коммутатор направляет кадр в нужную VLAN.

Пример атаки (с помощью yersinia):
bash
Copy
yersinia -I eth0 -G  # Атака через DTP
Что может злоумышленник?
✅ Доступ к изолированным VLAN (например, к VoIP или серверной сети).
✅ Перехват трафика между VLAN.

Защита:
Отключить DTP (настроить порты вручную).

Изменить native VLAN (не использовать VLAN 1).

Фильтрация MAC/IP между VLAN (ACL).

Сравнение атак
Атака	Уровень	Цель	Инструменты	Защита
ARP-spoofing	L2 (Ethernet)	Перехват трафика (MITM)	arpspoof, Ettercap	DAI, Static ARP, HTTPS
MAC-флуд	L2 (Ethernet)	Переполнение таблицы CAM	macof, Yersinia	Port Security, 802.1X
VLAN Hopping	L2 (VLAN)	Доступ к чужой VLAN	Yersinia, scapy	Отключение DTP, ACL
Вывод
ARP-spoofing — для перехвата трафика в локальной сети.

MAC-флуд — для нарушения работы коммутатора и сниффинга.

VLAN Hopping — для обхода сегментации сети.